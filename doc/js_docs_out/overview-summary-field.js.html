<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
InputEx Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="Field.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>InputEx</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>Field.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		This files contains the inputEx.Field class<BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="inputEx/Field.html">inputEx.Field</a></b></td>
    <td>inputEx.Field 
 </td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/** 
 * <span class="attrib">@fileoverview</span> This files contains the inputEx.Field class
 */</span>
<span class="comment">/** 
 * Create the dom and basic behaviour of an inputEx field
 *
 * <span class="attrib">@class</span> inputEx.Field 
 * <span class="attrib">@constructor</span>
 * <span class="attrib">@param</span> {Object} options Options object (see options property)
 */</span>
inputEx.Field = <span class="reserved">function</span>(options) {
	
	<span class="comment">/**
	 * Options :
	 * &lt;ul&gt;
    *	  &lt;li&gt;name: the name of the field&lt;/li&gt;
    *	  &lt;li&gt;numbersOnly: boolean, accept only numbers if true&lt;/li&gt;
    *	  &lt;li&gt;required: boolean, cannot be null if true&lt;/li&gt;
    *	  &lt;li&gt;regexp: regular expression used to validate (otherwise it always validate)&lt;/li&gt;
    *	  &lt;li&gt;tooltipIcon: show an icon next to the field and display an error in a tooltip (default false)&lt;/li&gt;
    *   &lt;li&gt;className: CSS class name for the div wrapper (default 'inputEx-Field')
    *   &lt;li&gt;size: size attribute of the input&lt;/li&gt;
    *   &lt;li&gt;value: initial value&lt;/li&gt;
    * &lt;/ul&gt;
	 */</span>
	<span class="reserved">this</span>.options = options || {};
	
	<span class="comment">// Set the default values of the options</span>
	<span class="reserved">this</span>.setOptions();
	
	<span class="comment">// Call the render of the dom</span>
	<span class="reserved">this</span>.render();
	
	<span class="comment">// Set the initial value</span>
	<span class="reserved">if</span>(<span class="reserved">this</span>.options.value) {
		<span class="reserved">this</span>.setValue(<span class="reserved">this</span>.options.value);
	}
	
	<span class="comment">/**
	 * YAHOO custom event "updated"
	 */</span>
	<span class="reserved">this</span>.updatedEvt = new YAHOO.util.CustomEvent(<span class="literal">'updated'</span>, <span class="reserved">this</span>);
	<span class="comment">//this.updatedEvt.subscribe(function(e, params) { var value = params[0]; console.log("updated",value); }, this, true);</span>
	
	<span class="comment">// initialize behaviour events</span>
	<span class="reserved">this</span>.initEvents();
	
	<span class="comment">// set the default styling</span>
	<span class="reserved">this</span>.setClassFromState();
};

<span class="comment">/**
 * Set the default values of the options
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.setOptions = <span class="reserved">function</span>() {
   
   <span class="comment">// Define default messages</span>
	<span class="reserved">this</span>.options.messages = <span class="reserved">this</span>.options.messages || {};
	<span class="reserved">this</span>.options.messages.required = <span class="reserved">this</span>.options.messages.required || inputEx.messages.required;
	<span class="reserved">this</span>.options.messages.invalid = <span class="reserved">this</span>.options.messages.invalid || inputEx.messages.invalid;
	<span class="reserved">this</span>.options.messages.valid = <span class="reserved">this</span>.options.messages.valid || inputEx.messages.valid;
	
	<span class="comment">// Other options</span>
	<span class="reserved">this</span>.options.size = <span class="reserved">this</span>.options.size || 20;
	<span class="reserved">this</span>.options.className = <span class="reserved">this</span>.options.className || <span class="literal">'inputEx-Field'</span>;
	<span class="reserved">this</span>.options.required = <span class="reserved">this</span>.options.required ? true : false;
	<span class="reserved">this</span>.options.tooltipIcon = <span class="reserved">this</span>.options.tooltipIcon ? true : false;
	
	<span class="comment">// The following options are used later:</span>
	<span class="comment">// + this.options.name</span>
	<span class="comment">// + this.options.regexp</span>
	<span class="comment">// + this.options.numbersOnly</span>
	<span class="comment">// + this.options.value</span>
	
};

<span class="comment">/**
 * Default render of the dom element
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.render = <span class="reserved">function</span>() {
	
	<span class="comment">// Create a DIV element to wrap the editing el and the image</span>
	<span class="reserved">this</span>.divEl = inputEx.cn(<span class="literal">'div'</span>, {className: <span class="reserved">this</span>.options.className});
	
	<span class="comment">// Render the component</span>
	<span class="reserved">this</span>.renderComponent();
	
	<span class="comment">// Create a div next to the field with an icon and a tooltip</span>
	<span class="reserved">if</span>( <span class="reserved">this</span>.options.tooltipIcon ) {
		<span class="reserved">this</span>.tooltipIcon = inputEx.cn(<span class="literal">'img'</span>, {src: inputEx.spacerUrl, className: <span class="literal">'inputEx-Field-stateIcon'</span>});
		<span class="reserved">if</span>(!inputEx.tooltipCount) { inputEx.tooltipCount = 0; }
   	<span class="reserved">this</span>.tooltip = new YAHOO.widget.Tooltip(<span class="literal">'inputEx-tooltip-'</span>+(inputEx.tooltipCount++), { context: <span class="reserved">this</span>.tooltipIcon, text:<span class="literal">""</span> }); 
		<span class="reserved">this</span>.divEl.appendChild(<span class="reserved">this</span>.tooltipIcon);
	}
	
};

<span class="comment">/**
 * Render the interface component
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.renderComponent = <span class="reserved">function</span>() {
   <span class="comment">// Attributes of the input field</span>
   var attributes = {};
   attributes.type = <span class="literal">'text'</span>;
   attributes.size = <span class="reserved">this</span>.options.size;
   <span class="reserved">if</span>(<span class="reserved">this</span>.options.name) attributes.name = <span class="reserved">this</span>.options.name;
   
   <span class="comment">// Create the node</span>
	<span class="reserved">this</span>.el = inputEx.cn(<span class="literal">'input'</span>, attributes);
	
	<span class="comment">// Append it to the main element</span>
	<span class="reserved">this</span>.divEl.appendChild(<span class="reserved">this</span>.el);
};

<span class="comment">/**
 * The default render creates a div to put in the messages
 * <span class="attrib">@return</span> {DOMElement} divEl The main DIV wrapper
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.getEl = <span class="reserved">function</span>() {
	<span class="reserved">return</span> <span class="reserved">this</span>.divEl;
};

<span class="comment">/**
 * Initialize events of the Input
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.initEvents = <span class="reserved">function</span>() {
	
	<span class="comment">// The "input" event doesn't exist in IE so we use the "keypress" with a setTimeout to wait until the new value has been set</span>
	<span class="comment">//YAHOO.util.Event.addListener(this.el, "input", this.onInput, this, true);</span>
	var that = <span class="reserved">this</span>;
	YAHOO.util.Event.addListener(<span class="reserved">this</span>.el, <span class="literal">"keypress"</span>, <span class="reserved">function</span>(e) { setTimeout(<span class="reserved">function</span>() { that.onInput(e); },50); });
	
	YAHOO.util.Event.addListener(<span class="reserved">this</span>.el, <span class="literal">"change"</span>, <span class="reserved">this</span>.onChange, <span class="reserved">this</span>, true);
	
	YAHOO.util.Event.addListener(<span class="reserved">this</span>.el, <span class="literal">"focus"</span>, <span class="reserved">this</span>.onFocus, <span class="reserved">this</span>, true);
	YAHOO.util.Event.addListener(<span class="reserved">this</span>.el, <span class="literal">"blur"</span>, <span class="reserved">this</span>.onBlur, <span class="reserved">this</span>, true);
   
};

<span class="comment">/**
 * Return the value of the input
 * <span class="attrib">@return</span> {String} value of the field
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.getValue = <span class="reserved">function</span>() {
	<span class="reserved">return</span> <span class="reserved">this</span>.el.value;
};

<span class="comment">/**
 * Function to set the value
 * <span class="attrib">@param</span> {String} value The new value
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.setValue = <span class="reserved">function</span>(value) {
	<span class="reserved">this</span>.el.value = value;
};

<span class="comment">/**
 * Set the styles for valid/invalide state
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.setClassFromState = <span class="reserved">function</span>() {
	
	<span class="reserved">if</span>( <span class="reserved">this</span>.previousState ) {
		YAHOO.util.Dom.removeClass(<span class="reserved">this</span>.getEl(), <span class="literal">'inputEx-'</span>+<span class="reserved">this</span>.previousState );
	}
	<span class="reserved">this</span>.previousState = <span class="reserved">this</span>.getState();
	YAHOO.util.Dom.addClass(<span class="reserved">this</span>.getEl(), <span class="literal">'inputEx-'</span>+<span class="reserved">this</span>.previousState );
	
	<span class="reserved">this</span>.setToolTipMessage();
};

<span class="comment">/**
 * Set the tooltip message
 */</span> 
inputEx.Field.<span class="reserved">prototype</span>.setToolTipMessage = <span class="reserved">function</span>() { 
	<span class="reserved">if</span>(<span class="reserved">this</span>.tooltip) {
	   var content = <span class="literal">""</span>;
		<span class="reserved">if</span>( <span class="reserved">this</span>.previousState == <span class="literal">'required'</span>) {
			content = <span class="literal">'&lt;div class="inputEx-tooltip-required"&gt;&lt;/div&gt; &lt;span&gt;'</span>+<span class="reserved">this</span>.options.messages.required+<span class="literal">'&lt;/span&gt;'</span>;
		}
		<span class="reserved">else</span> <span class="reserved">if</span>( <span class="reserved">this</span>.previousState == <span class="literal">'invalid'</span>) {
			content = <span class="literal">'&lt;div class="inputEx-tooltip-exclamation"&gt;&lt;/div&gt; &lt;span&gt;'</span>+<span class="reserved">this</span>.options.messages.invalid+<span class="literal">'&lt;/span&gt;'</span>;
		}
   	<span class="reserved">else</span> {
   		content = <span class="literal">'&lt;div class="inputEx-tooltip-validated"&gt;&lt;/div&gt; &lt;span&gt;'</span>+<span class="reserved">this</span>.options.messages.valid+<span class="literal">'&lt;/span&gt;'</span>;
   	}
   	<span class="reserved">this</span>.tooltip.setBody(content);
	}
};  

<span class="comment">/**
 * Function called on the focus event
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.onFocus = <span class="reserved">function</span>(e) {
	YAHOO.util.Dom.addClass(<span class="reserved">this</span>.getEl(), <span class="literal">'inputEx-focused'</span>);
};

<span class="comment">/**
 * Function called on the blur event
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.onBlur = <span class="reserved">function</span>(e) {
	YAHOO.util.Dom.removeClass(<span class="reserved">this</span>.getEl(), <span class="literal">'inputEx-focused'</span>);
};

<span class="comment">/**
 * Returns the current state (given its value)
 * <span class="attrib">@return</span> {String} One of the following states: 'empty', 'required', 'valid' or 'invalid'
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.getState = <span class="reserved">function</span>() { 
	<span class="comment">// if the field is empty :</span>
	<span class="reserved">if</span>( <span class="reserved">this</span>.getValue() === <span class="literal">''</span> ) {
	   <span class="reserved">return</span> <span class="reserved">this</span>.options.required ? inputEx.Field.stateRequired : inputEx.Field.stateEmpty;
	}
	<span class="reserved">return</span> <span class="reserved">this</span>.validate() ? inputEx.Field.stateValid : inputEx.Field.stateInvalid;
};
inputEx.Field.stateEmpty = <span class="literal">'empty'</span>;
inputEx.Field.stateRequired = <span class="literal">'required'</span>;
inputEx.Field.stateValid = <span class="literal">'valid'</span>;
inputEx.Field.stateInvalid = <span class="literal">'invalid'</span>;

<span class="comment">/**
 * Validation of the field
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.validate = <span class="reserved">function</span>() { 
	<span class="comment">// if we are using a regular expression</span>
	<span class="reserved">if</span>( <span class="reserved">this</span>.options.regexp ) {
		<span class="reserved">return</span> <span class="reserved">this</span>.getValue().match(<span class="reserved">this</span>.options.regexp);
	}
   <span class="reserved">return</span> true;
};  

<span class="comment">/**
 * onInput is called 50ms after a "keypress" event
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.onInput = <span class="reserved">function</span>(e) { 
	<span class="reserved">if</span>(<span class="reserved">this</span>.options.numbersOnly) {
		<span class="reserved">this</span>.setValue( <span class="reserved">this</span>.getValue().replace(/[^0-9]/g,<span class="literal">''</span>) );
	}
	
	<span class="reserved">this</span>.setClassFromState();
};  

<span class="comment">/**
 * onChange event handler
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.onChange = <span class="reserved">function</span>(e) {
	<span class="reserved">this</span>.setClassFromState();
	
	<span class="comment">// Fire the "updated" event (only if the field validated)</span>
	<span class="reserved">if</span>(<span class="reserved">this</span>.validate()) {
	   <span class="comment">// Uses setTimeout to escape the stack (that originiated in an event)</span>
	   var that = <span class="reserved">this</span>;
	   setTimeout(<span class="reserved">function</span>() {
   	   that.updatedEvt.fire(that.getValue());
	   },50);
   }
};

<span class="comment">/**
 * Close the field and eventually opened popups...
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.close = <span class="reserved">function</span>() {
   <span class="comment">// Please override this function...</span>
};

<span class="comment">/**
 * Disable the field
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.disable = <span class="reserved">function</span>() {
   <span class="reserved">this</span>.el.disabled = true;
};

<span class="comment">/**
 * Enable the field
 */</span>
inputEx.Field.<span class="reserved">prototype</span>.enable = <span class="reserved">function</span>() {
   <span class="reserved">this</span>.el.disabled = false;
};

<span class="comment">/**
 * Register this class as "string" type
 */</span>
inputEx.registerType(<span class="literal">"string"</span>, inputEx.Field);

</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>InputEx</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Sun Feb 24 19:49:22 2008</div>
</body>
</html>
